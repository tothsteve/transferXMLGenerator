[pytest]
# Pytest Configuration for Bank Transfers Backend

# Django settings module
DJANGO_SETTINGS_MODULE = transferXMLGenerator.settings

# Python files and directories to search for tests
python_files = test_*.py *_test.py
python_classes = Test* *Tests
python_functions = test_*

# Test discovery paths
testpaths = bank_transfers/tests

# Additional command line options
addopts =
    # Verbose output
    -v
    # Show local variables in tracebacks
    --showlocals
    # Show summary of all test outcomes
    -ra
    # Strict markers (fail on unknown markers)
    --strict-markers
    # Strict config (fail on unknown config options)
    --strict-config
    # Warnings
    -W ignore::DeprecationWarning
    -W ignore::PendingDeprecationWarning
    # Coverage (comment out if not using pytest-cov)
    --cov=bank_transfers
    --cov-report=html
    --cov-report=term-missing
    --cov-fail-under=80
    # Disable coverage for specific paths
    --cov-config=.coveragerc

# Markers for categorizing tests
markers =
    unit: Unit tests (fast, isolated)
    integration: Integration tests (may touch database)
    slow: Slow running tests
    api: API endpoint tests
    service: Service layer tests
    model: Model tests
    serializer: Serializer tests
    validator: Validator tests
    filter: FilterSet tests
    permission: Permission tests
    external: Tests requiring external services (MNB, Billingo API)

# Minimum Python version
minversion = 3.9

# Test execution options
# Run tests in parallel (requires pytest-xdist)
# addopts = -n auto

# Django database configuration for tests
# Tests will use a separate test database
django_find_project = false

# Console output style
console_output_style = progress

# Logging
log_cli = false
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Timeout for tests (requires pytest-timeout)
# timeout = 300

# Disable capturing for debugging (shows print statements)
# addopts = -s

# Run only failed tests from last run
# addopts = --lf

# Run failed tests first, then others
# addopts = --ff
